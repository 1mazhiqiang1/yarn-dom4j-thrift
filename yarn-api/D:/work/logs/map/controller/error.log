[2018-10-24T10:56:57.255+08:00] [ERROR] org.apache.thrift.server.AbstractNonblockingServer$FrameBuffer org.apache.thrift.server.AbstractNonblockingServer$FrameBuffer.invoke(AbstractNonblockingServer.java:524) : Unexpected throwable while invoking!
java.lang.ClassCastException: org.apache.thrift.transport.TFramedTransport cannot be cast to org.apache.thrift.transport.TSocket
	at com.sf.yarn.server.YarnRmApiServer$LogProcessor.process(YarnRmApiServer.java:66)
	at org.apache.thrift.server.AbstractNonblockingServer$FrameBuffer.invoke(AbstractNonblockingServer.java:518)
	at org.apache.thrift.server.TNonblockingServer.requestInvoke(TNonblockingServer.java:111)
	at org.apache.thrift.server.AbstractNonblockingServer$AbstractSelectThread.handleRead(AbstractNonblockingServer.java:210)
	at org.apache.thrift.server.TNonblockingServer$SelectAcceptThread.select(TNonblockingServer.java:203)
	at org.apache.thrift.server.TNonblockingServer$SelectAcceptThread.run(TNonblockingServer.java:154)
[2018-10-24T11:53:21.731+08:00] [ERROR] org.apache.thrift.server.AbstractNonblockingServer$FrameBuffer org.apache.thrift.server.AbstractNonblockingServer$FrameBuffer.invoke(AbstractNonblockingServer.java:524) : Unexpected throwable while invoking!
java.lang.ClassCastException: org.apache.thrift.transport.TFramedTransport cannot be cast to org.apache.thrift.transport.TSocket
	at com.sf.yarn.server.YarnRmApiServer$MyTServerEventHandler.processContext(YarnRmApiServer.java:98)
	at org.apache.thrift.server.AbstractNonblockingServer$FrameBuffer.invoke(AbstractNonblockingServer.java:516)
	at org.apache.thrift.server.TNonblockingServer.requestInvoke(TNonblockingServer.java:111)
	at org.apache.thrift.server.AbstractNonblockingServer$AbstractSelectThread.handleRead(AbstractNonblockingServer.java:210)
	at org.apache.thrift.server.TNonblockingServer$SelectAcceptThread.select(TNonblockingServer.java:203)
	at org.apache.thrift.server.TNonblockingServer$SelectAcceptThread.run(TNonblockingServer.java:154)
[2018-10-24T12:00:35.705+08:00] [ERROR] org.apache.thrift.server.AbstractNonblockingServer$FrameBuffer org.apache.thrift.server.AbstractNonblockingServer$FrameBuffer.invoke(AbstractNonblockingServer.java:524) : Unexpected throwable while invoking!
java.lang.ClassCastException: org.apache.thrift.transport.TFramedTransport cannot be cast to org.apache.thrift.transport.TSocket
	at com.sf.yarn.server.YarnRmApiServer$MyTServerEventHandler.processContext(YarnRmApiServer.java:98)
	at org.apache.thrift.server.AbstractNonblockingServer$FrameBuffer.invoke(AbstractNonblockingServer.java:516)
	at org.apache.thrift.server.TNonblockingServer.requestInvoke(TNonblockingServer.java:111)
	at org.apache.thrift.server.AbstractNonblockingServer$AbstractSelectThread.handleRead(AbstractNonblockingServer.java:210)
	at org.apache.thrift.server.TNonblockingServer$SelectAcceptThread.select(TNonblockingServer.java:203)
	at org.apache.thrift.server.TNonblockingServer$SelectAcceptThread.run(TNonblockingServer.java:154)
[2018-10-24T13:01:42.898+08:00] [ERROR] org.apache.thrift.server.TThreadPoolServer org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:300) : Thrift error occurred during processing of message.
org.apache.thrift.protocol.TProtocolException: Expected protocol id ffffff82 but got 0
	at org.apache.thrift.protocol.TCompactProtocol.readMessageBegin(TCompactProtocol.java:507)
	at org.apache.thrift.TBaseProcessor.process(TBaseProcessor.java:27)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:291)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
[2018-10-24T13:56:33.725+08:00] [ERROR] org.apache.thrift.server.TThreadPoolServer org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:300) : Thrift error occurred during processing of message.
org.apache.thrift.protocol.TProtocolException: Bad version in readMessageBegin
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:229)
	at org.apache.thrift.TBaseProcessor.process(TBaseProcessor.java:27)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:291)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
[2018-10-24T13:57:55.287+08:00] [ERROR] org.apache.thrift.server.TThreadPoolServer org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:300) : Thrift error occurred during processing of message.
org.apache.thrift.protocol.TProtocolException: Bad version in readMessageBegin
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:229)
	at org.apache.thrift.TBaseProcessor.process(TBaseProcessor.java:27)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:291)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
[2018-10-24T14:15:46.898+08:00] [ERROR] com.sf.yarn.client.YarnRmClient com.sf.yarn.client.YarnRmClient.main(YarnRmClient.java:42) : connect to YarnRmApi Server error:java.net.ConnectException: Connection refused (Connection refused)
org.apache.thrift.transport.TTransportException: java.net.ConnectException: Connection refused (Connection refused)
	at org.apache.thrift.transport.TSocket.open(TSocket.java:226)
	at com.sf.yarn.client.YarnRmClient.main(YarnRmClient.java:40)
Caused by: java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.thrift.transport.TSocket.open(TSocket.java:221)
	... 1 more
